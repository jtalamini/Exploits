import sys

# Example:
# string: http://kali/met.exe

# Output:
#	mov eax, 0xffffffff;
# 	sub eax, 0xff9a879a;
#	push eax;
#	push 0x2e74656d;
#	push 0x2f696c61;
#	push 0x6b2f2f3a;	
#	push 0x70747468;
#	push esp;

string = sys.argv[1]

dword_size = 8

print("\n# string: "+string)

dwords = ["\"push esp;\""]

dword = ""
for i in range(len(string)):
	hex_char = hex(ord(string[i]))[2:]
	if i > 0 and i % 4 == 0:
		dwords.append("\"push 0x"+dword+";\"")
		dword = ""
	dword = hex_char + dword
if len(dword) < dword_size:
	# fill DWORD with NULL bytes
	dword = "0"*(dword_size-len(dword))+dword
	print("# replace push 0x"+dword+" to avoid NULL bytes")
	dwords.append("\"push eax;\"")
	# subtract EAX of (0xffffffff - DWORD)
	dwords.append("\"sub eax, "+str(hex(0xffffffff - int(dword, 16)))+";\"")
	# mov 0xffffffff into EAX
	dwords.append("\"mov eax, 0xffffffff;\"")
else:
	dwords.append("\"push 0x"+dword+";\"")
	# NULL EAX register and push it
	dwords.append("\"push eax;\"")
	dwords.append("\"xor eax, eax;\"")
	
dwords.reverse()

for d in dwords:
	print(d)
